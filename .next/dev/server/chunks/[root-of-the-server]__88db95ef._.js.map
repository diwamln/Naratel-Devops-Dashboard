{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///home/duwa/Git/webui-devops/Naratel-Devops-Dashboard/src/lib/gitMutex.js"],"sourcesContent":["import { Mutex } from 'async-mutex';\n\n// Shared mutex instance to prevent race conditions during Git operations\nexport const gitMutex = new Mutex();\n"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,WAAW,IAAI,wMAAK"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///home/duwa/Git/webui-devops/Naratel-Devops-Dashboard/src/app/api/manifest/generate/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { execSync } from 'child_process';\nimport fs from 'fs';\nimport path from 'path';\nimport os from 'os';\nimport { gitMutex } from '@/lib/gitMutex';\n\nexport async function POST(req) {\n  const data = await req.json();\n  \n  const repoDirName = 'manifest-repo-workdir';\n  const repoPath = path.join(os.tmpdir(), repoDirName);\n  const registryPath = path.join(repoPath, 'registry.json');\n  \n  const token = process.env.GITHUB_TOKEN;\n  const repoUrl = process.env.MANIFEST_REPO_URL;\n  const userName = process.env.GIT_USER_NAME || \"Naratel DevOps Dashboard\";\n  const userEmail = process.env.GIT_USER_EMAIL || \"devops@naratel.com\";\n  const ageKey = \"age1ywhtcmyuhmfa32kfaaxcak4dvq27q9g6m55gqlzu2vlwkgfj24wq3g4ejx\"; // Public Key\n\n  if (!repoUrl || !token) {\n      return NextResponse.json({ error: \"Configuration Error: MANIFEST_REPO_URL or GITHUB_TOKEN is missing.\" }, { status: 500 });\n  }\n\n  return await gitMutex.runExclusive(async () => {\n      try {\n          // --- 0. Git Setup (Clone/Pull) ---\n          const authenticatedUrl = repoUrl.replace(\"https://\", `https://${token}@`);\n\n          if (!fs.existsSync(repoPath)) {\n              console.log(`Cloning repository to ${repoPath}...`);\n              execSync(`git clone ${authenticatedUrl} ${repoPath}`);\n              execSync(`git config user.name \"${userName}\"`, { cwd: repoPath });\n              execSync(`git config user.email \"${userEmail}\"`, { cwd: repoPath });\n          } else {\n              console.log(`Updating repository at ${repoPath}...`);\n              try {\n                 execSync(`git fetch origin`, { cwd: repoPath });\n                 execSync(`git reset --hard origin/main`, { cwd: repoPath });\n              } catch (e) {\n                 console.warn(\"Git pull/reset failed, attempting to re-clone...\", e.message);\n                 fs.rmSync(repoPath, { recursive: true, force: true });\n                 execSync(`git clone ${authenticatedUrl} ${repoPath}`);\n                 execSync(`git config user.name \"${userName}\"`, { cwd: repoPath });\n                 execSync(`git config user.email \"${userEmail}\"`, { cwd: repoPath });\n              }\n          }\n      } catch (error) {\n          console.error(\"Git Setup Failed:\", error.message);\n          return NextResponse.json({ error: \"Failed to initialize git repository: \" + error.message }, { status: 500 });\n      }\n\n      // --- CRITICAL FIX: Race Condition Check ---\n      // Read registry freshly pulled from git to verify ID availability\n      try {\n          if (fs.existsSync(registryPath)) {\n              const content = fs.readFileSync(registryPath, 'utf8');\n              const currentRegistry = JSON.parse(content);\n              \n              // Check if the requested ID is already taken\n              const isTaken = currentRegistry.some(app => app.id === data.appId);\n              \n              if (isTaken) {\n                  console.log(`[CONFLICT] App ID ${data.appId} is already taken. Calculating new ID...`);\n                  \n                  // Calculate new Max ID\n                  let maxId = 0;\n                  currentRegistry.forEach(app => {\n                      const idNum = parseInt(app.id);\n                      if (!isNaN(idNum) && idNum > maxId) {\n                          maxId = idNum;\n                      }\n                  });\n                  \n                  const newId = String(maxId + 1).padStart(3, '0');\n                  console.log(`[RESOLVED] Auto-assigning new ID: ${newId}`);\n                  data.appId = newId; // Override the ID\n              }\n          }\n      } catch (e) {\n          console.warn(\"Failed to validate App ID collision:\", e.message);\n          // Continue, worst case it overwrites or fails later\n      }\n      // ------------------------------------------\n\n      const generatedFolders = [];\n      const errors = [];\n\n      let safeImageRepo = data.imageRepo;\n      if (safeImageRepo && safeImageRepo.startsWith('dockerio/')) {\n          safeImageRepo = safeImageRepo.replace('dockerio/', '');\n      }\n\n      // --- Helper: Generate YAML Content (Split Values & Secrets) ---\n      const generateYaml = (templateType, env) => {\n        const appName = data.appName;\n        const appId = data.appId;\n        \n        // --- SECRETS Construction ---\n        const appSecretObj = {};\n        if (data.appSecrets && Array.isArray(data.appSecrets)) {\n            data.appSecrets.forEach(s => {\n                let val = s.value;\n                if (env === 'prod' && s.valueProd) val = s.valueProd;\n                if (env === 'testing' && s.valueTest) val = s.valueTest;\n                \n                if (s.key && val !== undefined && val !== null) {\n                    appSecretObj[s.key] = val;\n                }\n            });\n        }\n\n        if (data.dbType !== 'none') {\n            const dbPort = data.dbType === 'postgres' ? \"5432\" : \"3306\";\n            const dbName = data.appName.replace(/-/g, '_'); \n            \n            // FORCE overwrite DB_HOST and DB_PORT to match the Service we are generating\n            // FIX: Using FQDN because DB is in a separate isolated namespace now\n            // Format: svc-db-{appName}-{id}.{id}-db-{appName}-{env}.svc.cluster.local\n            appSecretObj[\"DB_HOST\"] = `svc-db-${data.appName}-${data.appId}.${data.appId}-db-${data.appName}-${env}.svc.cluster.local`;\n            appSecretObj[\"DB_PORT\"] = dbPort;\n            \n            // --- Standardize Keys (Map DB_USER -> DB_USERNAME, etc.) ---\n            if (appSecretObj[\"DB_NAME\"] && !appSecretObj[\"DB_DATABASE\"]) {\n                appSecretObj[\"DB_DATABASE\"] = appSecretObj[\"DB_NAME\"];\n            }\n            if (appSecretObj[\"DB_USER\"] && !appSecretObj[\"DB_USERNAME\"]) {\n                appSecretObj[\"DB_USERNAME\"] = appSecretObj[\"DB_USER\"];\n            }\n            if (appSecretObj[\"DB_PASS\"] && !appSecretObj[\"DB_PASSWORD\"]) {\n                appSecretObj[\"DB_PASSWORD\"] = appSecretObj[\"DB_PASS\"];\n            }\n\n            // --- Fill Defaults if still missing ---\n            if (!appSecretObj[\"DB_DATABASE\"]) appSecretObj[\"DB_DATABASE\"] = dbName;\n            if (!appSecretObj[\"DB_USERNAME\"]) appSecretObj[\"DB_USERNAME\"] = \"admin\";\n            if (!appSecretObj[\"DB_PASSWORD\"]) appSecretObj[\"DB_PASSWORD\"] = \"changeme_securely\";\n        }\n\n        const dbSecretObj = {};\n        if (data.dbSecrets && Array.isArray(data.dbSecrets)) {\n            data.dbSecrets.forEach(s => {\n                 let val = s.value;\n                 if (env === 'prod' && s.valueProd) val = s.valueProd;\n                 if (env === 'testing' && s.valueTest) val = s.valueTest;\n                 \n                 if (val && typeof val === 'string') val = val.trim();\n                 \n                 if (s.key && val !== undefined && val !== null) {\n                     dbSecretObj[s.key] = val;\n                 }\n            });\n        }\n        \n        if (data.dbType !== 'none') {\n             const dbName = data.appName.replace(/-/g, '_'); \n             \n             console.log(\"[DEBUG] Mapping DB Secrets for type:\", data.dbType);\n             console.log(\"[DEBUG] Initial dbSecretObj:\", JSON.stringify(dbSecretObj, null, 2));\n\n             if (data.dbType === 'postgres') {\n                // STRICT CLEANUP: Remove any MySQL keys that might have slipped in\n                Object.keys(dbSecretObj).forEach(k => {\n                    if (k.startsWith('MYSQL_') || k.startsWith('MARIADB_')) delete dbSecretObj[k];\n                });\n\n                // FORCE: Gunakan Key standar Bitnami PostgreSQL (POSTGRESQL_*)\n                // Prioritaskan input dari dbSecretObj (Form DB Secrets), fallback ke appSecretObj (Form App Secrets)\n                \n                const userDbName = dbSecretObj[\"POSTGRESQL_DATABASE\"] || dbSecretObj[\"POSTGRES_DB\"] || dbSecretObj[\"DB_NAME\"] || appSecretObj[\"DB_NAME\"] || dbName;\n                const userDbUser = dbSecretObj[\"POSTGRESQL_USERNAME\"] || dbSecretObj[\"POSTGRES_USER\"] || dbSecretObj[\"DB_USER\"] || appSecretObj[\"DB_USER\"] || \"admin\";\n                const userDbPass = dbSecretObj[\"POSTGRESQL_PASSWORD\"] || dbSecretObj[\"POSTGRES_PASSWORD\"] || dbSecretObj[\"DB_PASS\"] || appSecretObj[\"DB_PASS\"] || \"changeme_securely\";\n\n                dbSecretObj[\"POSTGRESQL_DATABASE\"] = userDbName;\n                dbSecretObj[\"POSTGRESQL_USERNAME\"] = userDbUser;\n                dbSecretObj[\"POSTGRESQL_PASSWORD\"] = userDbPass;\n                dbSecretObj[\"POSTGRESQL_POSTGRES_PASSWORD\"] = userDbPass; // Set postgres root pass\n                \n                // Cleanup non-standard/old keys\n                delete dbSecretObj[\"POSTGRES_DB\"];\n                delete dbSecretObj[\"POSTGRES_USER\"];\n                delete dbSecretObj[\"POSTGRES_PASSWORD\"];\n                delete dbSecretObj[\"DB_NAME\"];\n                delete dbSecretObj[\"DB_USER\"];\n                delete dbSecretObj[\"DB_PASS\"];\n                delete dbSecretObj[\"DB_USERNAME\"];\n                delete dbSecretObj[\"DB_PASSWORD\"];\n                delete dbSecretObj[\"DB_DATABASE\"];\n                \n             } else {\n                // STRICT CLEANUP: Remove any Postgres keys that might have slipped in\n                Object.keys(dbSecretObj).forEach(k => {\n                    if (k.startsWith('POSTGRES_') || k.startsWith('POSTGRESQL_')) delete dbSecretObj[k];\n                });\n\n                // FORCE: Gunakan Key standar Bitnami MariaDB (MARIADB_*)\n                const userDbName = dbSecretObj[\"MARIADB_DATABASE\"] || dbSecretObj[\"MYSQL_DATABASE\"] || dbSecretObj[\"DB_NAME\"] || appSecretObj[\"DB_NAME\"] || dbName;\n                const userDbUser = dbSecretObj[\"MARIADB_USER\"] || dbSecretObj[\"MYSQL_USER\"] || dbSecretObj[\"DB_USER\"] || appSecretObj[\"DB_USER\"] || \"admin\";\n                const userDbPass = dbSecretObj[\"MARIADB_PASSWORD\"] || dbSecretObj[\"MYSQL_PASSWORD\"] || dbSecretObj[\"DB_PASS\"] || appSecretObj[\"DB_PASS\"] || \"changeme_securely\";\n\n                dbSecretObj[\"MARIADB_DATABASE\"] = userDbName;\n                dbSecretObj[\"MARIADB_USER\"] = userDbUser;\n                dbSecretObj[\"MARIADB_PASSWORD\"] = userDbPass;\n                dbSecretObj[\"MARIADB_ROOT_PASSWORD\"] = dbSecretObj[\"MARIADB_ROOT_PASSWORD\"] || dbSecretObj[\"MYSQL_ROOT_PASSWORD\"] || \"changeme_root\";\n                \n                // Cleanup\n                delete dbSecretObj[\"MYSQL_DATABASE\"];\n                delete dbSecretObj[\"MYSQL_USER\"];\n                delete dbSecretObj[\"MYSQL_PASSWORD\"];\n                delete dbSecretObj[\"MYSQL_ROOT_PASSWORD\"];\n                delete dbSecretObj[\"DB_NAME\"];\n                delete dbSecretObj[\"DB_USER\"];\n                delete dbSecretObj[\"DB_PASS\"];\n             }\n             console.log(\"[DEBUG] Final dbSecretObj:\", JSON.stringify(dbSecretObj, null, 2));\n        }\n\n        const formatSecrets = (obj) => {\n            if (Object.keys(obj).length === 0) return '{}';\n            return Object.entries(obj)\n                .map(([k, v]) => {\n                    const safeVal = String(v).replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\"');\n                    return `  ${k}: \"${safeVal}\"`;\n                })\n                .join('\\n');\n        };\n\n        let values = \"\";\n        let secrets = \"\";\n\n        // A. APP PRODUCTION\n        if (templateType === 'app-prod') {\n            secrets = `secretData:\\n${formatSecrets(appSecretObj)}`;\n            values = `\nnamespace: prod\ncontrollerType: Deployment\n\napp:\n  id: \"${appId}\"\n  name: \"${appName}\"\n  env: \"prod\"\n\nimage:\n  repository: \"${safeImageRepo}\"\n  tag: \"${data.imageTag}\"\n\nservice:\n  port: ${data.servicePort}\n  targetPort: ${data.targetPort}\n`.trim();\n\n            if (data.migrationEnabled) {\n                values += `\n\nmigration:\n  enabled: true\n  command: \"${data.migrationCommand}\"`;\n            }\n\n            if (data.dbType !== 'none') {\n                values += `\n\nbackup:\n  enabled: true\n  type: \"${data.dbType}\"`;\n            }\n\n            if (data.ingressEnabled) {\n                values += `\n\ningress:\n  enabled: true\n  className: \"nginx\"\n  hosts:\n    - host: \"${data.ingressHost}\"\n      path: /\n`;\n                if (data.tlsEnabled) {\n                    values += `  tls:\n    - secretName: \"${appName}-tls\"\n      hosts:\n        - \"${data.ingressHost}\"`;\n                }\n            }\n        }\n\n        // B. APP TESTING\n        if (templateType === 'app-testing') {\n            secrets = `secretData:\\n${formatSecrets(appSecretObj)}`;\n            values = `\nnamespace: testing\ncontrollerType: Deployment\n\napp:\n  id: \"${appId}\"\n  name: \"${appName}\"\n  env: \"testing\"\n\nimage:\n  repository: \"${data.imageRepo}\"\n  tag: \"${data.imageTag}\"\n\nservice:\n  type: NodePort\n  port: ${data.servicePort}\n  targetPort: ${data.targetPort}\n`.trim();\n\n            if (data.migrationEnabled) {\n                values += `\n\nmigration:\n  enabled: true\n  command: \"${data.migrationCommand}\"`;\n            }\n\n            if (data.dbType !== 'none') {\n                values += `\n\nbackup:\n  enabled: true\n  type: \"${data.dbType}\"`;\n            }\n\n            if (data.ingressEnabled) {\n                values += `\n\ningress:\n  enabled: true\n  className: \"nginx\"\n  hosts:\n    - host: \"test-${data.ingressHost}\"\n      path: /\n`;\n            }\n        }\n\n        // C. DB PRODUCTION\n        if (templateType === 'db-prod') {\n            const dbImage = data.dbType === 'postgres' ? 'devopsnaratel/postgresql' : 'devopsnaratel/mariadb';\n            const dbTag = data.dbType === 'postgres' ? '18.1' : '12.1.2'; \n            const dbPort = data.dbType === 'postgres' ? 5432 : 3306;\n\n            secrets = `secretData:\\n${formatSecrets(dbSecretObj)}`;\n            values = `\nnamespace: prod\ncontrollerType: StatefulSet\n\napp:\n  id: \"${appId}\"\n  name: \"db-${appName}\"\n  env: \"prod\"\n\nimage:\n  repository: \"${dbImage}\"\n  tag: \"${dbTag}\"\n\nservice:\n  port: ${dbPort}\n  targetPort: ${dbPort}\n\nbackup:\n  enabled: true\n  type: \"${data.dbType}\"\n`.trim();\n        }\n\n        // D. DB TESTING\n        if (templateType === 'db-testing') {\n            const dbImage = data.dbType === 'postgres' ? 'devopsnaratel/postgresql' : 'devopsnaratel/mariadb';\n            const dbTag = data.dbType === 'postgres' ? '18.1' : '12.1.2';\n            const dbPort = data.dbType === 'postgres' ? 5432 : 3306;\n\n            secrets = `secretData:\\n${formatSecrets(dbSecretObj)}`;\n            values = `\nnamespace: testing\ncontrollerType: StatefulSet\n\napp:\n  id: \"${appId}\"\n  name: \"${appName}-db\"\n  env: \"testing\"\n\nimage:\n  repository: \"${dbImage}\"\n  tag: \"${dbTag}\"\n\nservice:\n  port: ${dbPort}\n  targetPort: ${dbPort}\n\nbackup:\n  enabled: true\n  type: \"${data.dbType}\"\n`.trim();\n        }\n\n        return { values, secrets, appSecretObj, dbSecretObj };\n      };\n\n\n      // --- Helper: Write & Encrypt ---\n      const processManifest = (folderName, type, env) => {\n          const targetFolder = path.join(repoPath, 'apps', folderName);\n          const valuesPath = path.join(targetFolder, 'values.yaml');\n          const secretsPath = path.join(targetFolder, 'secrets.yaml');\n\n          if (fs.existsSync(targetFolder)) {\n              console.log(`Folder ${folderName} exists, updating...`);\n          } else {\n              fs.mkdirSync(targetFolder, { recursive: true });\n          }\n\n          const { values, secrets, appSecretObj, dbSecretObj } = generateYaml(type, env);\n          \n          // DEBUG: Log the secrets being generated to verify values (Keys only for safety)\n          console.log(`[DEBUG] Generating ${folderName} (${env}):`);\n          if (type.startsWith('app')) {\n             console.log(\"App Secret Keys:\", Object.keys(appSecretObj));\n          } else {\n             console.log(\"DB Secret Keys:\", Object.keys(dbSecretObj));\n          }\n\n          // 1. Write Plaintext Values\n          fs.writeFileSync(valuesPath, values);\n\n          // 2. Write Secrets\n          fs.writeFileSync(secretsPath, secrets);\n\n          // 3. Encrypt Secrets ONLY\n          try {\n              execSync(`sops --encrypt --age ${ageKey} --encrypted-regex '^(secretData)$' --in-place ${secretsPath}`, { cwd: repoPath });\n              generatedFolders.push(folderName);\n          } catch (e) {\n              console.error(`Encryption failed for ${folderName}`, e);\n              errors.push(`Encryption failed for ${folderName}: ${e.message}`);\n          }\n      };\n\n\n      try {\n          // GENERATE PROD ONLY (Testing is now Ephemeral/On-Demand via Jenkins)\n          processManifest(`${data.appName}-prod`, 'app-prod', 'prod');\n\n          if (data.dbType !== 'none') {\n              processManifest(`${data.appName}-db-prod`, 'db-prod', 'prod');\n          }\n\n          // Update Registry\n          try {\n              let registry = [];\n              if (fs.existsSync(registryPath)) {\n                  const content = fs.readFileSync(registryPath, 'utf8');\n                  try { registry = JSON.parse(content); } catch (e) { registry = []; }\n              }\n              const existingIdx = registry.findIndex(r => r.id === data.appId);\n              const newEntry = {\n                  id: data.appId,\n                  name: data.appName,\n                  image: `${safeImageRepo}:${data.imageTag}`,\n                  db: data.dbType,\n                  ingressHost: data.ingressEnabled ? data.ingressHost : null,\n                  createdAt: new Date().toISOString()\n              };\n              if (existingIdx >= 0) {\n                  registry[existingIdx] = newEntry;\n              } else {\n                  registry.push(newEntry);\n              }\n              fs.writeFileSync(registryPath, JSON.stringify(registry, null, 2));\n          } catch (regError) {\n              errors.push(\"Failed to update registry.json: \" + regError.message);\n          }\n\n          if (errors.length > 0) {\n              return NextResponse.json({ error: errors.join(', '), generated: generatedFolders }, { status: 400 });\n          }\n\n          // Commit & Push\n          const commitMsg = `feat: add/update manifests for ${data.appName} (split structure)`;\n          execSync(`git add .`, { cwd: repoPath });\n          try {\n              execSync(`git commit -m \"${commitMsg}\"`, { cwd: repoPath });\n              execSync(`git push origin main`, { cwd: repoPath });\n          } catch (e) {\n              if (e.message.includes('nothing to commit')) {\n                  return NextResponse.json({ message: \"No changes detected.\" });\n              }\n              throw e;\n          }\n\n          return NextResponse.json({\n              message: `Success! Generated ${generatedFolders.join(', ')}`,\n              folders: generatedFolders\n          });\n\n      } catch (err) {\n          console.error(err);\n          return NextResponse.json({ error: err.message }, { status: 500 });\n      }\n  });\n}"],"names":[],"mappings":"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"}}]
}