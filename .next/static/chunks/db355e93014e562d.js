(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3604,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},519,e=>{"use strict";let t=(0,e.i(80522).default)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);e.s(["GitBranch",()=>t],519)},742,e=>{"use strict";let t=(0,e.i(80522).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],742)},33711,65037,e=>{"use strict";var t=e.i(80522);let r=(0,t.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>r],33711);let a=(0,t.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>a],65037)},18863,e=>{"use strict";let t=(0,e.i(80522).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],18863)},90582,e=>{"use strict";var t=e.i(3788),r=e.i(44274),a=e.i(47528),s=e.i(50549),l=e.i(80522);let n=(0,l.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var d=e.i(90564),i=e.i(742),c=e.i(33711);let o=(0,l.default)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),x=(0,l.default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var u=e.i(519),m=e.i(65037),p=e.i(18863);let h=e=>{if(!e)return null;let t=e.match(/(\d+)\.(\d+)\.(\d+)/);return t?{full:t[0],major:parseInt(t[1],10),minor:parseInt(t[2],10),patch:parseInt(t[3],10)}:null};function b(){let[e,r]=(0,a.useState)([]),[l,b]=(0,a.useState)(!0),[g,f]=(0,a.useState)(!1),[k,y]=(0,a.useState)(null),[j,v]=(0,a.useState)({text:"",type:""}),[N,w]=(0,a.useState)(!1),C=(0,a.useRef)(0),z=(0,a.useCallback)(async(e=!1)=>{let t=++C.current;e&&f(!0);try{let e=await fetch("/api/jenkins/pending",{cache:"no-store",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(8e3)});if(t!==C.current)return;if(!e.ok)throw Error("API_ERROR");let a=await e.json(),s=Array.isArray(a)?a:a.data||[];r(s),w(!1)}catch(e){console.error("Fetch Error:",e),t===C.current&&w(!0)}finally{t===C.current&&(b(!1),f(!1))}},[]);(0,a.useEffect)(()=>{z();let e=setInterval(()=>z(!0),1e4);return()=>clearInterval(e)},[z]);let A=(0,a.useMemo)(()=>{if(!e.length)return{groups:{},names:[]};let t=e.reduce((e,t)=>{let r=t.jobName;return e[r]||(e[r]=[]),e[r].push(t),e},{});Object.keys(t).forEach(e=>{t[e].sort((e,t)=>{let r=h(e.name),a=h(t.name);return r||a?r?a?r.major!==a.major?a.major-r.major:r.minor!==a.minor?a.minor-r.minor:a.patch-r.patch:-1:1:t.timestamp-e.timestamp})});let r=Object.keys(t).sort();return{groups:t,sortedNames:r}},[e]),M=async(e,t,r)=>{y(`${e}-${r}`),v({text:"",type:""});try{let a=await fetch("/api/jenkins/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({buildId:e,jobName:t,action:r})}),s=await a.json();if(s.success)v({text:s.message||"Action processed successfully",type:"success"}),setTimeout(()=>z(!0),1e3);else throw Error(s.message||"Failed to execute action")}catch(e){v({text:e.message,type:"error"})}finally{y(null)}};return(0,t.jsxs)("div",{className:"w-full",children:[j.text&&(0,t.jsxs)("div",{className:`mb-6 p-4 rounded-lg border flex items-center gap-3 text-sm animate-in fade-in slide-in-from-top-2 ${"success"===j.type?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-300"}`,children:["success"===j.type?(0,t.jsx)(s.CheckCircle,{size:18}):(0,t.jsx)(c.AlertTriangle,{size:18}),(0,t.jsx)("span",{className:"font-medium",children:j.text}),(0,t.jsx)("button",{onClick:()=>v({text:"",type:""}),className:"ml-auto hover:opacity-70",children:(0,t.jsx)(n,{size:16})})]}),l?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-neutral-500",children:[(0,t.jsx)(d.Loader2,{size:48,className:"animate-spin text-[#FFA500] mb-4"}),(0,t.jsx)("p",{children:"Syncing with Jenkins..."})]}):N?(0,t.jsxs)("div",{className:"col-span-full py-20 text-center flex flex-col items-center justify-center text-neutral-500 border-2 border-dashed border-red-200 dark:border-red-800/50 rounded-2xl bg-red-50/50 dark:bg-red-900/10",children:[(0,t.jsx)(o,{size:48,className:"text-red-300 mb-4"}),(0,t.jsx)("h3",{className:"font-semibold text-lg text-red-600 dark:text-red-400",children:"Connection Failure"}),(0,t.jsx)("p",{className:"text-sm max-w-sm mt-2",children:"Failed to fetch data from Jenkins API endpoint. Ensure VPN or tunnel is active."}),(0,t.jsxs)("button",{onClick:()=>z(),className:"mt-6 flex items-center gap-2 bg-neutral-900 hover:bg-neutral-800 text-white dark:bg-white dark:text-neutral-900 font-bold py-2 px-6 rounded-lg transition-all",children:[(0,t.jsx)(m.RefreshCw,{size:18})," Retry Connection"]})]}):0===e.length?(0,t.jsxs)("div",{className:"col-span-full py-20 text-center flex flex-col items-center justify-center text-neutral-500 border-2 border-dashed border-neutral-200 dark:border-neutral-800 rounded-2xl bg-white/50 dark:bg-neutral-900/50",children:[(0,t.jsx)(s.CheckCircle,{size:48,className:"text-neutral-300 mb-4"}),(0,t.jsx)("p",{className:"font-semibold text-lg",children:"All caught up!"}),(0,t.jsx)("p",{className:"text-sm max-w-sm mt-2",children:"No pipelines are currently waiting for approval."})]}):(0,t.jsx)("div",{className:"flex flex-col gap-8",children:A.sortedNames.map(e=>(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 px-1",children:[(0,t.jsx)("div",{className:"p-1.5 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:(0,t.jsx)(x,{size:16,className:"text-[#FFA500]"})}),(0,t.jsx)("h2",{className:"text-lg font-bold text-neutral-900 dark:text-white tracking-tight",children:e}),(0,t.jsxs)("span",{className:"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 dark:text-neutral-400 text-xs font-mono font-bold px-2 py-0.5 rounded-full border border-neutral-200 dark:border-neutral-700",children:[A.groups[e].length," PENDING"]}),(0,t.jsx)("div",{className:"h-px flex-1 bg-neutral-200 dark:bg-neutral-800 ml-2"})]}),(0,t.jsx)("div",{className:"grid gap-4",children:A.groups[e].map(e=>{let r=h(e.name);k&&k.startsWith(e.id);let a=e.tag?e.tag.startsWith("v")?e.tag:`v${e.tag}`:r?`v${r.full}`:e.name;return(0,t.jsxs)("div",{className:"bg-white dark:bg-neutral-900 rounded-xl border border-neutral-200 dark:border-neutral-800 shadow-sm hover:shadow-md transition-all group overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-6 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsxs)("span",{className:"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-[10px] font-mono font-bold px-2 py-0.5 rounded-full border border-amber-200 dark:border-amber-700 flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"})," WAITING INPUT"]}),(0,t.jsxs)("span",{className:"bg-neutral-100 dark:bg-neutral-800 text-neutral-500 dark:text-neutral-400 text-[10px] font-mono font-bold px-2 py-0.5 rounded-full border border-neutral-200 dark:border-neutral-700",children:["ID: ",e.id]}),e.tag&&(0,t.jsxs)("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-[10px] font-mono font-bold px-2 py-0.5 rounded-full border border-blue-200 dark:border-blue-700 flex items-center gap-1",children:["TAG: ",e.tag]})]}),(0,t.jsxs)("h3",{className:"text-xl font-bold text-neutral-900 dark:text-white flex items-center gap-2",children:[(0,t.jsx)(u.GitBranch,{className:"text-neutral-400",size:20}),a]}),(0,t.jsx)("div",{className:"flex items-center gap-4 mt-2 text-xs text-neutral-500 font-mono",children:(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(i.Clock,{size:12}),(0,t.jsx)("span",{children:new Date(e.timestamp).toLocaleString("id-ID")})]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:()=>M(e.id,e.jobName,"approve"),disabled:!!k,className:"px-4 py-2.5 text-[11px] font-bold uppercase tracking-wider bg-neutral-900 text-white dark:bg-neutral-100 dark:text-neutral-900 rounded-lg hover:bg-green-600 dark:hover:bg-green-500 hover:text-white dark:hover:text-white transition-all shadow-sm disabled:opacity-50 flex items-center gap-2 min-w-[100px] justify-center",children:k===`${e.id}-approve`?(0,t.jsx)(d.Loader2,{size:14,className:"animate-spin"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Check,{size:14})," Deploy"]})}),(0,t.jsx)("button",{onClick:()=>M(e.id,e.jobName,"abort"),disabled:!!k,className:"px-4 py-2.5 text-[11px] font-bold uppercase tracking-wider bg-white text-neutral-700 dark:bg-neutral-800 dark:text-neutral-300 border border-neutral-200 dark:border-neutral-700 rounded-lg hover:bg-red-600 hover:border-red-600 dark:hover:bg-red-500 dark:hover:border-red-500 hover:text-white dark:hover:text-white transition-all shadow-sm disabled:opacity-50 flex items-center gap-2",children:k===`${e.id}-abort`?(0,t.jsx)(d.Loader2,{size:14,className:"animate-spin"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n,{size:14})," Abort"]})})]})]}),(0,t.jsx)("div",{className:"h-1 w-full bg-neutral-50 dark:bg-neutral-800/50 mt-0",children:(0,t.jsx)("div",{className:"h-full bg-amber-500/20 w-full animate-pulse"})})]},e.id)})})]},e))})]})}function g(){return(0,t.jsx)(r.default,{children:(0,t.jsx)(b,{})})}e.s(["default",()=>g],90582)}]);